# Advanced Functions - Practice Problems

## Problem 1: Window Functions - Ranking
1. Rank employees by salary within department
2. Dense rank products by price within category
3. Row number for pagination
4. NTILE to divide into quartiles
5. Rank with ties handling

## Problem 2: Window Functions - Aggregation
1. Running total of sales by date
2. Moving average (7-day window)
3. Cumulative sum by category
4. YTD (Year-To-Date) totals
5. Percentage of total by group

## Problem 3: LAG and LEAD
1. Compare with previous row (month-over-month growth)
2. Calculate day-to-day changes
3. Find first and last values in partition
4. Detect gaps in sequences
5. Calculate time between events

## Problem 4: String Functions
1. Extract domain from email
2. Format phone numbers
3. Parse JSON strings
4. Clean and standardize text
5. Generate slugs from titles
6. Find and replace patterns

## Problem 5: Date/Time Functions
1. Calculate age from birthdate
2. Extract fiscal quarter
3. Find business days between dates
4. Generate date series
5. Time zone conversions
6. Date arithmetic and intervals

## Problem 6: JSON Operations
1. Extract nested JSON values
2. Query JSONB with operators
3. Aggregate to JSON arrays/objects
4. Update JSON fields
5. Validate JSON structure
